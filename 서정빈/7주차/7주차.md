# 인프라 스터디 7주차 정리

## 클라우드 컴퓨팅이란?

서버 클라이언트-아키텍처 : 서버 - 클라이언트 구조로 서버 중심 관리하는 방법

데이터센터 : 어플리케이션의 서버를 호스팅하는 실제 시설 → 서버실

- 컴퓨팅 시스템을 위한 하드웨어
- 네트워킹 장비
- 전원공급장치
- 전기 시스템
- 백업 발전기
- 환경 제어장치(에어컨, 냉각장치, 팬)
- 운영 인력 및 기타 인프라

→ 이런 과정에서 유지보수비가 장난이 없음 / 구축시간이 느림
새로운 개념인 클라우드가 등장 → 온디맨드, 사용한 만큼만 돈을 지불

### 장점

자본 비용→ 가변 비용으로 대체하며, 쓰는 만큼 지불하는 개념으로 변경
규모의 경제로 얻게되는 이점(규모의 경제는 여러개 사면 단가가 낮아지는 것을 말함 // 공구)
속도 및 민첩성 → 리소스 빠른 확보 및 빠른 개발에 도움
데이터 센터 운영 및 유지보수 투자 비용 불필요함 + 빠른 확장성(전 세계에)

## 클라우드 컴퓨팅의 종류

어플리케이션의 구성 : Network, 저장소(HDD/SSD), 컴퓨팅(CPU, RAM), OS(Windows, Linux), 어플리케이션으로 이루어짐

### laaS(Infrastructure as s Service || ex : AWS EC2)

- 인프라만 제공, OS를 직접 설치, 필요 SW를 개발해 사용
- 가상의 컴퓨터를 하나 임대하는 것
- Network, 저장소와 컴퓨팅층까지 담당

### PaaS(Platform as s Service || ex : Firebase, Google App Engine)

- 인프라 + OS + 기타 프로그램 실행에 필요한 부분(런타임)
- 바로 코드만 올려 돌릴 수 있도록 구성

### SaaS(Software as a Service || ex : Gmail, Slack, Google Docs)

- 서비스 자체 제공
- 다른 세팅 없이 서비스만 이용

클라우딩 컴퓨팅 배포 모델 : 공개형, 혼합형, 폐쇄형이 있음

### 공개형(클라우드)

- 모든 부분이 클라우드에서 실행
- 낮은 비용 및 높은 확장성을 가짐

### 혼합형(하이브리드)

- 폐쇄형과 공개형의 혼합
- 폐쇄형에서 공개형으로 전환하는 과도기에 사용
- 폐쇄형의 백업용으로도 사용함

### 폐쇄형

- 높은 수준의 커스터마이징 가능
- 비싼 초기 비용 및 유지보수 비용
- 장점으로는 높은 보안을 가짐

## 리전, 가용영역

### 리전

- AWS 서비스의 물리적 위치
- 각 리전에는 고유의 코드 부여(ex : ap-northeast-2)
- 리전 별로 가능한 서비스 다름(us-east-1은 서비스가 먼저 출시되는 리전)

![1. region.png](1.%20region.png)


위의 그림처럼 AWS 자체, 리전, 가용영역에서 돌릴 수 있는 것들이 분리되어있음

### 리전 고려사항

- 지연 속도
- 법률(데이터, 서비스 제공관련)
- 사용할 서비스

### 가용 영역

- 하나의 리전은 반드시 2개 이상의 가용영역으로 구성
- 하나 이상의 데이터 센터로 구성
- 리전간 연결은 매우 빠른 전용 네트워크 연결
- 반드리 물리적 일정 거리 떨어짐(자연재해에 대한 대비 및 보안)
- 실제적으로 데이터 센터에 각각 분산해줌

### 엣지로케이션

- AWS의 CloudFront 등 여러 서비스를 가장 빠른 속도로 캐싱하기 위한 거점
- 전 세계에 여러 장소에 흩어져 있음

### 글로벌 서비스와 리전 서비스

- AWS 서비스 제공 지역에 따라 글로벌과 리전으로 나뉨
- 글로벌 서비스 : 데이터 및 서비스를 전 세계 인프라가 공유(CloudFront, IAM, Route53, WAF)
- 리전 서비스 : 특정 리전을 기반으로 데이터 및 서비스를 제공(대부분 + S3(전세계 공유 가능하나 데이터는 리전에 가짐)

### ARN(Amazon Resource Name)

AWS의 모든 리소스의 고유 아이디

## IAM

### IAM

- AWS 서비스와 리소스에 대한 액세스를 안전하게 관리
- AWS 사용자 및 그룹을 만들고 관리하며 AWS 리소스에 대한 액세스를 허용 및 거부
- 글로벌 서비스임
- 사용자 : 실제 AWS를 사용하는 사람 및 App을 의미
- 그룹 : 사용자의 집합 / 그룹에 속한 사용자는 그룹에 부여된 권한을 행사
- 정책 : 사용자와 그룹, 역할이 무엇인지에 관한 문서 / JSON으로 정의
- 역할 : AWS 리소스에 부여, 무엇을 하는지 정의 / 사용자가 역할 부여받아 사용
  다른 자격에 대해 신뢰관계 구축 가능 / 역할을 바꾸어 가며 서비스를 사용 가능
- 역할에 정책이 부여되어있는지 확인하여 서비스를 이용할 수 있음

### IAM User(Identity and Access Management)

- 만들 때 주어진 아이디로 로그인
- 기본 권한이 없으므로 따로 권한을 부여해야함(팀마다 따로 한다던지..)
- AWS API 호출 가능(AccessKey와 Secret Access Key)

### 사용자의 종류

- 루트 사용자 : 결제 관리 및 포함한 계정 모든 권한을 가짐
- 관리 목적 이외에는 사용 비추
- MFA(Multi-factor authentication) : 일회용 패스워드 생성해 로그인
- IAM 사용자 : IAM을 통해 생성 및 사용하는 사용자
- 한 사람이나 하나의 어플리케이션을 의미
- 설정 시 콘솔 로그인 권한 부여 및 AWS 서비스 사용 가능
- adminAccess를 부여해도 루트로 설정 X → 결제 기능 사용 불가

## 가상화

VM으로 다수의 가상 컴퓨터로 분할할 수 있도록 해주는 기술

### 가상화의 역사

- 1세대 : 완전 자동화(Fully Emulated)
- 모든 시스템 요소가 에뮬레이션 안에서 돌아감
- 모든 것을 에뮬레이션으로 구현하여 OS와 연동, 많이 느림
- 2세대 : Paravirtrualization
- Guest OS는 하이퍼바이저와 통신(OS와 HW 사이 존재하는 일종의 가상화 매니저)
- 속도의 향상이 있었지만 몇몇은 에뮬레이터가 필요 → 느림
- 3세대 : Hardware Virtual Machine(HVM)
- HW에서 직접 가상화를 지원
- 직접 Guest-OS가 하드웨어와 통신 = 빠른 속도

### 가상화와 클라우드

- AWS 클라우드 환경에서 리소스를 작은 단위로 빠르게 구성할 수 있는 원동력
- 이미 구축된 가상화 가능 서버의 한 부분을 할당하는 것

### EC2의 특성

- 초 단위 온디맨드 모델 : 쓴 만큼만 돈 냄
- 빠른 구축 속도와 확장성 : 몇 분이면 전 세계에 인스턴스 수 백여대 구축 가능
- 다양한 구성방법 지원 : 머신러닝, 웹서버, 게임서버 등 서버 구성 가능 / 과금모델 사용
- 여러 AWS 서비스와 연동 : ELB, CloudWatch

### EC2 가격정책

- 온 디맨드
- 시간 또는 초당 컴퓨팅 파워로 측저오딘 가격을 지불
- 약정 X, 한 번 써보고 싶을 때 사용
- 장기적인 수요 예측이 힘들거나 유연한 EC2 사용하고 싶을 때
- Spot Instance
- 경매 형식으로 시장에 남는 인스턴스를 저렴하게 구매하여 씀
- 내 지정 가격보다 현재 가격이 낮음/높음 → 사용/반환
- 90% 정도 저렴하게 사용하나, 언제 돌려줘야 할 지 미지수
- 시작 종료가 자유롭거나 추가적인 컴퓨팅 파워가 필요한 경우
- 예약 인스턴스
- 미리 일정 기간을 약정해서 쓰는 방식(1년에서 3년)
- 최대 75% 정도 저렴함, 수요 예측이 확실할 때
- 총 비용 절감을 위해 어느정도 기간 약정이 가능한 사용자
- 전용 호스트
- 실제 물리 서버를 임대하는 방식
- 라이선스 이슈, 규정에 따라 필요한 경우
- 퍼포먼스 이슈(CPU steal)

## EC2 인스턴스 유형(많다)

![2. ec2 instance.png](2.%20ec2%20instance.png)

- 인스턴스의 CPU 갯수 / 메모리 크기 / 성능 등으로 사이즈 결정
- 크기가 클 수록 더 많은 메모리/CPU/네트워크 대역폭/EBS와 통신 가능한 대역폭
- 테스트 할 때 쓰던 t2.micro는 프리티어로 제공

### EBS

- 가상의 하드디스크
- EC2 꺼져도 계속 유지 가능
- 인스턴스 정지 후 재기동 가능 / 하나의 EBS에 여러 EC2 장착 가능
- 루트 볼륨으로 사용시, EC2가 종료되면 같이 삭제됨 → 설정을 통해 존속 가능
- EC2와 같은 가용영역에 존재

### Snapshot

- 특정 시간 EBS 상태의 저장본(사진마냥 → 도커때도 학습한 내용)
- S3에 보관

### AMI

- EC2 인스턴스를 실행하기 위해 필요한 정보를 모은 단위
- OS, 아키텍처 타입(32bit or 64bit), 저장공간 용량
- AMI를 사용하여 EC2를 복제하거나 다른 리전/계정으로 전달 가능
- Snapshot을 기반으로 AMI 구성 가능

### AMI 구성

- 1개 이상의 EBS 스냅샷
- 인스턴스 저장용 인스턴스라면 루트 볼륨에 대한 템플릿(OS, App server, App)
- 사용 권한(AWS 계정 누가 쓸 수 있는지)
- 블록 디바이스 맵핑(EC2 인스턴스를 위한 볼륨 정보 = EBS가 무슨 용량으로, 몇 개)

## EC2 생명 주기

![3. ec2 lifecycle1.png](3.%20ec2%20lifecycle1.png)

![4. ec2 lifecycle2.png](4.%20ec2%20lifecycle2.png)

### 중지

- 중지 중 인스턴스 요금 미청구, EBS나 탄력적 IP는 청구(VPC는 꼭 끄기.. 돈 자꾸 나감..)
- 중지 후 재시작시 퍼블릭 IP 변경
- EBS를 사용하는 인스턴스만 중지 가능 → 인스턴스 저장 인스턴스는 중지 불가

### 재부팅

- 재부팅시에는 퍼블릭 IP의 변경이 없음
- 최대 절전모드는 메모리 내용을 보존, 재시작시 중단 지점에서 시작하는 정지모드
- 팁으로는 CloudWatch를 이용해 시간을 조절하면 요금 절약에 도움이 됨

## 오토스케일링

스케일 업 - 비용이 비쌈(크기와 가격이 비례하지 않음)
스케일 아웃 - 비용이 비례(성능 고민을 많이 해야함)

### AWS 오토스케일링

- 정확한 수의 EC2 인스턴스를 보유하도록 보장 - 최소와 최대를 보정
- 다양한 스케일링 정책 적용 가능(CPU의 부하에 따라 인스턴스 크기 늘리기)
- 가용 영역에 인스턴스가 골고루 분산될 수 있도록 인스턴스를 분배

### 오토스케일링의 구성

- 시작 구성/시작 템플릿 : 무엇을 실행시킬 것인가?
- EC2의 타입, 사이즈, AMI, 보안 그룹, Key, IAM, 유저 데이터
- 모니터링 : 언제 실행시킬 것인가? + 상태 확인
- CPU 점유율이 일정 %을 넘어섰을 때 추가로 실행 / CloudWatch(or ELB)와 연계
- 설정 : 얼마나 어떻게 실행시킬 것인가?
- 최대 / 최소 / 원하는 인스턴스 숫자
- ELB와 연동 등

## ELB(Elastic Load Balancer)

- 다수의 서비스에 트래픽을 분산 시켜주는 서비스
- Health Check : 직접 트래픽을 발생시켜 Instance가 살아있는지 체크
- 오토 스케일링과 연동 가능
- 여러 가용영역에 분산 가능
- 지속적으로 IP 주소가 바뀌며 IP 구종 불가능 → 항상 도메인 기반으로 사용
- ALB(Application Load Balancer) - 트래픽 모니터링하여 라우팅 가능

### 대상 그룹(Target Group)

- ALB가 라우팅 할 대상의 집합
- Instance / IP / Lambda / ALB + 프로토콜 + 기타 설정 등

![4. ALB Targetgroup.png](4.%20ALB%20Targetgroup.png)

## EFS(Elastic File System)

EFS는 클라우드 서비스와 온프레미스 리소스에서 사용 가능한 간단/확장 가능한 탄력적 완전관리형 NFS 파일 시스템을 제공 → 대충 멀티형 EBS

- NFS 기반 공유 스토리지 서비스(NFSv4)
- 따로 용량 지정 X 사용한 만큼 용량 증가
- 페타바이트(와우) 단위까지 확장 가능
- 몇 천개의 동시 접속 유지 가능
- 데이터 여러 AZ에 나누어 분산 저장
- 쓰기 후 읽기(Read After Write) 일관성
- AWS 외부 접속 불가능 → 별도의 VPC와 연결이 필요함

### Amazon EFS 퍼포먼스 모드

- General Purpose : 가장 보편적임
- Max IO : 매우 높은 IOPS(Input/Output Operations Per Second, ***IOPS***)가 필요한 경우(빅데이터 및 미디어 처리 등)

### Amazon EFS Throughput 모드(Throughput : 데이터 전송 처리량)

- Bursting Throughput : 낮은 Throughput일 때 크레딧을 모아서 높은 Throughput일 때 사용
- Provisioned Throughput : 미리 지정한 만큼의 Throughput을 미리 확보하고 사용

### Amazon EFS 스토리지 클래스

- EFS Standard : 3개 이상의 가용영역에 보관
- EFS Standard - IA : 3개 이상의 가용영역 보관, 조금 저렴하지만 데이터 가져올 때 비용 발생
- EFS One Zone : 하나의 가용영역에 보관 → 가용영역의 상황에 영향 받기 가능
- EFS One Zone - IA : 위와 동일, 데이터 가져올 때 비용 발생

### 사설 IP

- 한정된 IP 주소를 최대한 활용을 위해 IP 주소를 분할하기 위해 만든 개념
- 사설망
- 사설망 내부에는 외부 인터넷 망으로 통신이 불가능한 사설 IP 있음
- 외부로 통신시 통신 가능한 공인 IP로 나누어 사용
- 보통 하나의 망에는 사설 IP를 부여받은 기기들과 NAT 기능을 갖춘 GateWay로 구성

### NAT(Network Address Translation)

- 사설 IP가 공용 IP로 통신할 수 있도록 주소를 변환해주는 방법
- 3가지 종류
- Dynamic NAT : 1개의 사설 IP를 가용 가능한 공인 IP로 연결 → 현재 사용가능한 IP 가져와 연결
- Static NAT : 하나의 사설 IP를 고정된 하나의 공인 IP로 연결 → AWS Internet Gateway 사용방식
- PAT(Port Address Translation) → 많은 사설 IP를 하나의 공인 IP로 연결

Dynamic NAT

![5. Dynamic NAT.png](5.%20Dynamic%20NAT.png)

### CIDR(Classless Inter Domain Routing)

- IP는 주소의 영역을 여러 네트워크 영역으로 나누기 위해 IP를 묶는 방식
- 여러 개의 사설망을 구축하기 위해 망을 나누는 방법

### CIDR Block / CIDR Notation

- CIDR Block : IP 주소의 집합
- CIDR Notation : CIDR Block을 표시하는 방법
- 네트워크 주소와 호스트 주소로 구성
- 각 호스트 주소 숫자만큼의 IP를 가진 네트워크 망 형성 가능
- A.B.C.D/E 형식
- 예 : 10.0.1.0/24 → 네트워크 주소 및 호스트 주소 표시/네트워크 주소가 몇 bit인지 표시
- CIDR 블럭은 호스트 주소 비트만큼 IP 주소를 보유 가능(ex : 192.168.2.0/24)
- 네트워크 비트 24
- 호스트 주소는 = 32 - 24 = 8
- 2^8 = 256개의 IP 주소 보유
- 192.168.2.0 ~ 192.168.2.255까지 총 256개의 주소 보유 가능

![6. CIDR.png](6.%20CIDR.png)

### VPC

- 가상의 데이터 센터
- 외부 격리된 네트워크 컨테이너 구성 가능(원하는 사설망과 부여된 IP 대역 분할 사용)
- 리전 단위 / EC2, RDS등 AWS 컴퓨팅 서비스 실행 및 다양한 서브넷 구성
- 구성요소
- 서브넷 / 인터넷 게이트웨이 / NACL / 보안그룹 / 라우팅 테이블 / NAT gateway / VPC Endpoint / Bastion Host
  → 여기서 서버 구축 할 때 VPC Endpoint 말고는 다 써본 거 같다

### 서브넷

- VPC 하위 단위, VPC에 할당된 IP를 더 작은 단위로 분할한 개념
- 하나의 서브넷은 하나의 AZ에 위치 / CIDR로 IP 주소 지정
- IP 숫자는 5개 제외(0 : 네트워크 어드레스, 1 : VPC 라우터, 2 : DNS 서버, 3 : 미래 , 255 : 네트워크 브로드캐스트 어드레스 | 안 쓰긴 함)
- 퍼블릭 서브넷 : 외부에서 인터넷을 통해 연결할 수 있는 서브넷
- IGW를 통해 외부 인터넷과 연결
- 안의 인스턴스에 퍼블릭 IP 부여 가능
- 웹서버처럼 유저에게 노출되어야하는 인프라
- 프라이빗 서브넷 : 외부에서 인터넷을 통해 연결할 수 없는 서브넷
- 외부 인터넷 경로 X
- 퍼블릭 IP 부여 X
- DB나 로직 서버같이 노출 될 필요 없는 인프라

### IGW(Internet GateWay)

- VPC가 외부의 인터넷과 통신할 수 있도록 경로를 만들어주는 리소스
- 기본적으로 확장성과 고가용성 확보
- IPv4, IPv6지원(IPv4는 NAT 역할) / 라우팅 테이블에서 경로 설정 후 접근(공짜)

### 보안그룹

- NACL과 방화벽 역할
- Port 허용
- 거부 불가능
- 모든 포트 비활성화, 포트와 소스를 설정 가능(선택적)
- 인스턴스 단위
- 하나의 인스턴스에 하나 이상 설정 가능
- NACL의 경우 서브넷 단위
- 설정된 인스턴스는 설정한 모든 SG의 룰을 적용 받음
- Well-Known port : 지정해놓고 쓰는 포트(22, 80, 8080 등)
- Stateful하므로 인바운드에서 지나갔으면 아웃바운드는 허락함

### NACL

- 보안그룹 같이 방화벽 역할
- 서브넷 단위
- 거부 가능(Port / IP)
- 순서대로 규칙 평가(낮은 숫자부터)
- Stateless하므로 인바운드에서 지나가도 아웃바운드에서 다시 검사함

### NACL 규칙

- 규칙 번호 : 규칙에 부여되는 고유 숫자, 규칙 평가 순서(위에서 말했듯 낮은 숫자부터)
  → 100단위로 추천(사이에 번호 넣을 일 생길 수 있어서)
- 유형 : 미리 지정된 프로토콜 // 규칙에 지정
- 프로토콜 : 통신 프로토콜(TCP, UDP 등등)
- 포트 범위 : 허용 혹은 거부할 포트 범위
- 소스 : IP 주소의 CIDR 블록
- 허용/거부 : 허용 또는 거부 여부를 선택

전체적으로는 아래의 구조를 가진다

![7. SG, NACL Structure.png](7.%20SG%2C%20NACL%20Structure.png)

### NAT 게이트웨이

- Private 인스턴스가 외부와 통신할 수 있도록 하는 통로
- Instance를 사용할 수 있는데, 요즘은 잘 안 씀(필요하면 이거 써도 됨)
- NAT Gateway/Instance는 모두 서브넷 단위
  → Public Subnet에 있어야함(NAT GateWay의 위치)

### Bastion 호스트

- Private 인스턴스에 접근하기 위한 EC2 인스턴스 / 실전에서 잘 안 씀
- 얘도 Public Subnet에 있어야함

## S3

### Amazon S3

- 객체 스토리지 서비스 : 파일 보관만 가능함 → 앱 설치 불가능
- 글로벌 서비스 / 단 데이터는 리전에 저장
- 무제한 용량(0byte ~ 5TB // 넘어가면 나눠서 보관)
- 구성은 Owner, Key-Value, Version Id, Metadata, ACL(파일 권한), Torrents(토렌트 공유)

### 버킷

- S3의 저장공간 구분단위
- 폴더 개념 / 전 세계 고유값의 이름을 가짐

### 내구성

- 최소 3개의 AZ에 데이터 분산 저장
- 내구성 완전 높음 99.9(11개..) (파일을 잃어버리지 않는 능력)
- 99.9%의 SLA 가용성(원할 때 파일을 쓰는 능력)

### 보안 설정

- S3 모든 버킷은 새로 생성시 기본적 Private → 설정을 통해 불특정 다수 공개 가능
- 보안 설정은 객체와 버킷으로 구성 가능
- MFA를 활용해 객체 삭제 방지 가능(MFA : 다중 인증)
- 버저닝을 통해 파일 관리 가능(Git / Docker처럼)
- 액세스 로그 생성 및 전송 가능 → 다른 버킷 혹은 다른 계정으로 전송 가능

### S3 스토리지 클래스

- S3 스탠다드 / S3 스탠다스 IA
- S3 One Zone-IA / S3 Glacier Instant Retrieval / S3 Glacier Flexible Retrieval
- S3 Glacier Deep Archive / S3 Intelligent-Tiering..

### IAM 정책

- 자격 증명 기반 정책
- 자격 증명(IAM 유저, 그룹, 역할)에 부여하는 정책
- 해당 자격증명으로 어떤 것을 할 수 있는지 허용
- 리소스 기반 정책(S3에서는 이거 씀)
- 리소스에 부여하는 정책
- 해당 리소스에 누가 무엇을 할 수 있는지 허용

→ 명시적 Deny시 권한 X / 리소스 기반 정책의 허용이 된다면 상시 허용

![8. IAM Policy.png](8.%20IAM%20Policy.png)

### S3 버킷 정책

- 버킷 단위로 부여되는 리소스 기반 정책
- 해당 버킷 데이터에 “언제 어디서 누가 어떻게 무엇을” 할 수 있는 지 정의 가능
- 기본적으로 모든 Bucket은 Private

### 버킷 관리 방법

- 자격 증명 기반 정책
- 같은 계정의 IAM 엔티티의 S3 권한 관리할 때
- S3이외의 다른 AWS 서비스와 같이 권한 관리할 때
- 리소스 기반 정책
- 익명 사용자 혹은 다른 계정의 엔티티의 S3 이용권한을 관리할 때
- S3만의 권한을 관리할 때
- ACL(Access Control List)
- 버킷 혹은 객체 단위 Read, Write 권한 부여
- S3에서 설정을 통해 ACL 활성화 후 적용
- 파일 업로드 시 설정 가능 / 간단하고 단순한 권한 관리만 가능 → 요즘 안 씀

### S3 버전 관리

- 객체의 생성, 업데이트, 삭제의 모든 단계를 저장
- 삭제시에는 실제 객체를 삭제 X → 삭제 마커를 추가(soft delete인듯) // 스택같다
- 버킷 단위로 활성화 필요(기본적 비활성화)
- 중지 가능(비활성화는 불가능)
- 한 번 버전 관리를 시작하면 비활성화 불가능(삭제 후 재생성으로 해결 가능)
- 수명 주기 관리 및 연동 가능, MFA 인증 후 삭제로 보안 강화 가능

### S3 객체 잠금

- Write Once, Read Many(WORM) 모델을 활용해 객체 저장
- 고정된 시간, 혹은 무기한 객체 삭제/덮어쓰기 방지 가능
- 규정 준수 및 객체 보호를 위해 사용 / 버전의 활성화 필요
- 보관모드(Retention Mode) : 일정 기간 수정 방지
- 규정 준수 모드 : 누구도 잠금 설정 변경 및 객체 삭제 불가능
- 거버넌스 모드 : 특별권한 없이 삭제 혹은 잠금 설정 불가능
- 법적 보존(Legal Hold)
- Hold를 객체에 부여, Hold가 존재하는 한 객체 삭제, 수정 불가능
- 제한 기간이 없음

![9. S3 Object Lock.png](9.%20S3%20Object%20Lock.png)

### S3 객체 암호화

- On Transit : SSL/TLS(HTTS) - 통신 과정에서 암호화
- At Rest(Server Side) - 저장시 암호화
1. SSE S3 : S3에서 알아서 암호화 // AWS 관할이라 관리 불가능
2. SSE KMS : KMS 서비스를 이용해 암호화(Encryption 키로 암호화) // 관리 가능
3. SSE C : 클라이언트에서 제공한 암호를 통해 암호화 // 클라이언트가 직접 키를 관리
- Client Side : 못 믿겠으니 내가 직접 암호화 // 미리 암호화해서 S3에 저장

### 정적 컨텐츠와 동적 컨텐츠

정적 컨텐츠(Static Contents)

- 서버 저장된 파일이 모든 사용자에게 동일 전달되는 컨텐츠
- 매번 서버 요청 필요 X, HTML, JS로 구성
- 이미지나 글, 뉴스 등

동적 컨텐츠(Dynamic Contents)

- 시간, 사용자, 입력 등에 따라 내용이 변경되는 컨텐츠
- 매번 서버에 요청해 내용 구성 및 전달 받음, PHP, JSP 등으로 서버 처리
- 로그인이나 게시판, 댓글 등

### S3 Static Hosting

- S3를 이용해 정적 웹 컨텐츠를 호스팅하는 기능
- 별도 서버 X, 웹사이트 호스팅 가능
- 고가용성/장애 내구성 확보
- 대규모 접속 예상되는 사전 예약 페이지, 홍보 페이지에 사용
- public으로 여는 경우 권한 부여가 필요
- S3 Block Public Access 해제 필요
- Bucket Policy에서 정책 허용 필요
- Route 53을 이용한 도메인으로 연결 가능
- 버킷 명 = 호스트 주소여야 함
- CloudFront랑 연동이 필요함(HTTPS 프로토콜 구현을 위해서) // SSL 키 관리 필요

![10. S3 Static Hosting.png](10.%20S3%20Static%20Hosting.png)

## OSI 7 Layer

### Session Layer

- 통신 주체끼리 연결이 유지 될 수 있는 방법을 정의
- 예전의 컴퓨팅 환경에서 Layer 1, 2, 3, 4 이외의 차원에서 지속적인 연결(세션)이 수립될 수 있는 방법을 제공 → MAC 주소와 IP 주소, 포트가 동일하면 어떻게 유저를 구분하는지?
- HTTP cookie를 이용하는 방법
- IP에서 인증 요청 후, 쿠키 값을 세션에 저장, IP가 바뀌더라도 동일한 쿠키값을 가지므로 문제 X
- FTP를 이용하면, 인증 이후 IP 값이 달라지는 순간 인증을 다시 할 떄 정보가 없기에 Deny 당함

### Presentation Layer

- 받은 데이터를 해석하는 방법을 정의
- 파싱, 압축 해제, 복호화 등 Application Layer에서 사용할 수 있는 형식으로 변환

### Application Layer

- 실제 받은 데이터를 처리하는 방법을 정의
- 데이터를 어떻게 처리할 지?
- ex) Get / Post / Put / Delete 등..

## DNS

### DNS란?

- DNS(Domain Name System) : 사람이 읽을 수 있는 문자열과 Internet 프로토콜 기반의 정보를 매칭하는 시스템
- 도메인 : 대상의 IP 주소등 정보와 매핑되는 사람이 알아볼 수 있는 문자열
  서브 도메인 : 도메인 중 스트링 앞에 추가 문자열이 붙은 도메인(ex : text.example.com)
  APEX 도메인 : 도메인 중 앞에 추가 문자열이 없는 순수 최상위 도메인(ex: example.com)
- 레코드(DNS Record) : 도메인이 어떤 방식으로 데이터와 매칭되는지 정의하는 기록
- 다양한 레코드 종류가 있고, 각각 다른 정보와 매칭

![11. DNS Mapping.png](11.%20DNS%20Mapping.png)

그림을 보면 각 동그라미 친 도메인들이 레코드임 → 각각 매핑 되어있음을 볼 수 있음

### DNS 주요 개념

- Domain Zone : 도메인의 정보를 담은 레코드의 집합
- Zone file : Domain Zone 정보를 저장한 텍스트 파일
- DNS Query : 주어진 도메인에 해당하는 정보를 요청하는 쿼리
- Name Server(NS) : DNS Query를 Zone File을 기반으로 응답할 수 있는 서버
- Authoritative : DNS 정보의 원본을 가지고 있는 가장 최상위 NS 서버
- None-Authoritative : Authoritative NS 서버 조회, 정보를 보관하거나 응답하는 서버(캐시)
- DNS Resolver : 사용자와 NS 서버 사이 위치한 서버, 실제 유저요청에 따라 IP 주소 같은 정보를 확보하는 서버
- 유저의 클라이언트가 먼저 쿼리를 요청하는 대상, 보통 ISP가 관리함

### 도메인의 구조

ex ) lecture.awsclassroom.kr.{}의 주소가 있다고 한다면,
lecture : SubDomain
awsclassroom : Domain
kr : Top Level Domain
{} : DNS Root

![12. DNS Layer.png](12.%20DNS%20Layer.png)

→ 처럼 계층 구조를 가짐을 알 수 있음

### DNS Root

- DNS 계층 구조의 최상위 레벨
- 위에서 말했듯 DNS Query 수행 시 최초 조회 거점
- 다음 단계인 TLDs(Top Level Domain)의 Zone file을 가진 NS서버의 주소 정보 보유
- IANA(Internet Assigned Numbers Authority)에서 조율하는 주체에서 관리
- A~M까지 각 관리 주체별로 다른 서버 주소를 가짐
- Root Hints File
- DNS Root의 주소를 담은 파일
- 각 DNS Resolver에 하드 코딩



### Top Level Domains(TLDs)

- DNS 계층 구조의 두 번째 레벨
- 실질적으로 정보를![13. DNS Root.png](13.%20DNS%20Root.png) 가지는 최상위 레벨
- ex) com. org. net 등등등
- 종류
- Country Code TLDs : 각 나라 할당 코드( .kr / .jp / .uk)
- Sponsored TLDs : 사설 조직이나 기관 할당 코드( .edu / .gov)
- New Generic TLDs : 기타 다양한 TLDs ( .app / .tech)
- 관리 주체 : TLDs Registry(각 회사/나라 등).. 관리 기관이 있다

![14. TLDs.png](14.%20TLDs.png)

### NS 서버

- 실제 도메인의 레코드를 가지고 있는 서버
- NS서버의 주소를 TLDs에 등록해두면 클라이언트에서 DNS 쿼리에 따라 이쪽으로 도착

![15. NS Server.png](15.%20NS%20Server.png)

이 과정을 통해서 Domain을 알아내고, 매핑해준 IP를 통하여 최종 주소를 클라이언트에게 전달

![16. SubDomain.png](16.%20SubDomain.png)
